#!/bin/bash

REGEXP=$1
VERBOSE=true
MODE=container

verbose()
{
    if [ "$VERBOSE" = "true" ]
    then
        echo "$*" 1>&2
    fi
         
}

stop_containers()
{
    verbose "Find containers matching: \"$REGEXP\""
    IDS=$(docker container list | grep -v CONTAINER | grep ${REGEXP} | awk '{ print $1}')
    verbose "Containers found:         $IDS"
    for id in $IDS
    do
        verbose "Stop container:           $id"
        docker stop $id
    done
    verbose "My work here is done"
}



case $MODE in
    "container")
        stop_containers
        ;;
    *)
        echo "Missing implementation"
        ;;
esac
        

